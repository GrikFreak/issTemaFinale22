<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
	font-size: 93%;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h1, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 90%;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 90%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	font-size: 90%;
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	font-size: 90%;
}
kr{
	font-family: "Arial";
	font-weight: bold;
    color: #ff0000	;
	font-size: 90%;
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{

    font-size: 18px;
}
k{
    color: #990000;
	font-weight: bold;
	font-size: 90%;
}
h1 {
    font-size: 150%;
    background-color: #b2c0ff;
	padding: 10px;
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #ccffcc;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;

}
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}
div.remark{
	background-color: #E3F2FD;
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

#exampleclass tbody,
#exampleclass thead,
#exampleclass th {
  border: 0;
}

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed

}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>

<head>

<title>Final task ISS-2022: Waste service</title></head>

<body>
<div id="top">
<h1>Final task ISS-2022: Waste service<font size="5"></font> </h1>
</div>

<div class="body">


<h2>Introduction</h2>
<div id="Introduction">
  This document deals with the design, build and development of a software system, named <ks>WasteService</ks>,
  which implements a series of functions to separate collection of waste.
</div>
<h2>Requirements</h2>
<div id="Requirements" class="remark">
    <p> <a id="R1">(R1)</a> The main goal of the <kr>WasteService</kr> software is to allow a <kr>Waste truck</kr> to deposit its load of
        <strong>TruckLoad</strong> kg plastic or glass in the proper container.</p>
        <p>The global story can be described as follows:</p>
        <ol class="arabic simple">
        <li><p><a id="R1A">(R1A)</a> The <cite>Waste truck</cite> driver approaches the <cite>INDOOR</cite> and sends (using a smart device) a request to store the load,
        by specifyng the <cite>type of  the material</cite> (plastic or glass) and its <cite>TruckLoad</cite>.</p></li>
        <li><p><a id="R1B">(R1B)</a> The <cite>WasteService</cite> sends the answer <em>loadaccept</em> if the final content of proper container will not surpass the
        maximum value allowed (<em>MAXPB</em> or <em>MAXGB</em>). Otherwise, it sends the answer <em>loadrejecetd</em> and the  <cite>Waste truck</cite>
        leaves the <cite>INDOOR</cite> area.</p></li>
        <li><p><a id="R1C">(R1C)</a> When the load is accepted, the <cite>transport trolley</cite> reaches the <cite>INDOOR</cite>, picks up the material, goes to the
        proper container and settles the material. During this activity, the <cite>WasteService</cite> <strong>blinks</strong> the <cite>Led</cite></p></li>
        <li><p><a id="R1D">(R1D)</a> When the deposit action is terminated, the <cite>transport trolley</cite>  excutes another deposit command (if any)
        or returns to its <cite>HOME</cite>.</p></li>
        </ol>
        <p> <a id="R2">(R2)</a> The <cite>WasteService</cite> must create a <kr>WasteServiceStatusGUI</kr> that shows to the <em>Service-manager</em>:</p>
        <ul>
        <li><p><a id="R2A">(R2A)</a> the current state of the <cite>transport trolley</cite> and it position in the room</p></li>
        <li><p><a id="R2B">(R2B)</a> the current weigth of the material stored in the two waste-containers</p></li>
        <li><p><a id="R2C">(R2C)</a> the current state of the <cite>Led</cite>
    </p>
</div>

<h2>Requirement analysis</h2>
<div class="remark">
  <div>
    Our <b>interaction with the customer</b> has clarified that nouns have the following meanings:
    <ul>
      <li><ks>transport trolley</ks>: component which uses the <ks>DDR Robot</ks> in order to complete his tasks;</li>
      <li><ks>software</ks>:set of computer programs and associated documentation and data ;</li>
      <li><ks>waste-load(or TruckLoad)</ks>: amount of chemical, physical, or biological matter contained within a waste discharge;</li>
      <li><ks>weight</ks>: relative mass or the quantity of matter contained by something;</li>
      <li><ks>material</ks>: matter from which a thing is or can be made; in our case could be only glass or plastic;</li>
      <li><ks>service-area</ks>:detailed area of the map where the Robot can move;</li>
      <li><ks>INDOOR</ks>: port in the service area where the waste material enters;</li>
      <li><ks>PlasticBox</ks>: container devoted to store objects made of plastic;</li>
      <li><ks>GlassBox</ks>: container devoted to store objects made of glass;</li>
      <li><ks>HOME</ks>:detailed area where it's initially placed the robot;</li>
      <li><ks>MAXPB</ks>: limits of weight (in kg ) that the PlasticBox can contain;</li>
      <li><ks>MAXGB</ks>: limits of weight (in kg ) that the GlassBox can contain;</li>
      <li><ks>obstacles</ks>: walls which marks the limit of the <ks>room</ks>;</li>
      <li><ks>DDR</ks>:physical or virtual (simulated in an virtual environment) object which can be represented and controlled using the infomation in basicrobot22;</li>
      <li><ks>transport trolley</ks>: component which uses the DDR Robot in order to complete his tasks;</li>
      <li><ks>RD</ks>:side lenght of the square that forms the transport trolley;</li>
      <li><ks>Waste truck</ks>:truck specially designed to collect  solid waste and transport it to a solid waste treatment facility;</li>
      <li><ks>deposit action (or command)</ks>: action that consists in these phases:
                            <ul>
                              <li>1. pick up a waste-load from a Waste truck located on the INDOOR</li>
                              <li>2. go from the INDOOR to the proper waste container</li>
                              <li>3. deposit the waste-load in the container</li>
                            </ul>
      </li>
      <li><ks>state</ks>: current status of the service area;</li>
      <li><ks>WasteServiceStatusGUI</ks>: user interface which allows the <kr>ServiceManager</kr> to supervise the state of the service-area;</li>
      <li><ks>Sonar</ks>: is a device that uses sound waves to detect objects;</li>    
      <li><ks>Led</ks>: is light source that emits light when current flows through it;</li>  
      <li><ks>RaspberryPi</ks>: single board computer;</li>  
      <li><ks>warning devices</ks>: a device that signals the occurrence of some undesirable event;</li>  
      <li><ks>LedState</ks>:
                            <ul>
                                <li>1. <kr>off</kr>: the led is off when the transport trolley is at HOME</li>
                                <li>2. <kr>blinks</kr>: the Led blinks while the transport trolley is moving</li>
                                <li>3. <kr>on</kr>: the Led is on when transport trolley is stopped</li>
                            </ul>
      </li>  
      <li><ks>DLIMIT</ks>: maximum distance, detected by the sonar, beyond which it triggers an action;</li> 
      <li><ks>alarm device</ks>: a device that gives an audible, visual or other kind of alarm signal to alert someone to a problem or condition that requires urgent attention;</li>                     
    </ul>
  </div>
  <div>
    Regarding action or verbs:
    <ul>
      <li><ks>build</ks>: construct (something) by putting parts or material together;</li>
      <li><ks>compose</ks>: the system is supplied with the necessary items for a particular purpose;</li>
      <li><ks>enter</ks>: the <ks>waste material</ks> is in the system;</li>
      <li><ks>pick-up (or store)</ks>:  action to load the material in the <ks>transport trolley</ks>;</li>
      <li><ks>go</ks>: action to describe the movement of the <ks>transport trolley</ks> ;</li>
      <li><ks>connect</ks>: the association between the <ks>Led</ks> and the <ks>Sonar</ks> with the RaspberryPi;</li>
      <li><ks>deposit</ks>: put the waste-load in the right container;</li>
      <li><ks>supervise</ks>: action performed by the <ks>Service-manager</ks> to check the status of the service-area using a <ks>WasteServiceStatusGUI</ks>;</li>
      <li><ks>connect</ks>: the <ks>OUTDOOR-area</ks> is free;</li>
      <li><ks>move</ks>: the action performed by the transport trolley to go from an area to an another one;</li>
      <li><ks>stop</ks>: the action of finish doing something that you were doing;</li>
      <li><ks>measure</ks>: the counting of a distance did by the sonar;</li>
      <li><ks>resume</ks>: the continue of the trasport trolley action due to a stop;</li>
      <li><ks>detect</ks>: the action did by <ks>Sonar</ks> to find object;</li>
      <li><ks>send</ks>: the action to communicate the answer;</li>
      <li><ks>settle</ks>: the placing in the specific container the current  <ks>Waste load</ks> ;</li>
      <li><ks>terminate</ks>: the end of a deposit ac;</li>
      <li><ks>execute</ks>: the run of a deposit action;</li>
    </ul>
  </div>
</div>
<br>
<div class="remark">
 the <ks>Sonar</ks> is autonomous component ? it has a global view of the system?
</div>
<div class="remark">
  The two actuators (<ks>transport trolley</ks> and <ks>Led</ks>), they are controlled by WasteService ?  <!-- Questo modello di linguaggio di modellazione è un custom dsl sviluppate dal committente
  e possono essere ritrovate nella seguente libreria. -->
</div>

<h2>Problem analysis</h2>

<div class="remark" id = "problem_analysis">
  The system is composed by distributed heterogeneous components that must communicate with each others.
  The problem is evaluating which technologies fit the best way for the transmission of information.
  Another problem is the management of the transport trolley as a core feature of the system.<br>
</div>
  This legend (?) will be used to represent the components in the problem analysis.

<div id="System_communication_overview">
  <h4>System communication overview</h4>
  <div class="remark">
    The interaction can be generally expressed as <ks>procedure calls</ks> or <ks>message based</ks>. However,
    since a distributed system is being developed, communication is a major aspect of the system itself and fit best in a message based interaction. <br>
    Depending on the nature and task of each component of the system, they will need a different form of interaction.
  <br>
    Moreover, in order to use this semantic, the system can relies on different communication protocol:
    <ul>
      <li><ks>websocket</ks>;</li>
      <li><ks>HTTP</ks>;</li>
      <li><ks>Pub-Sub</ks>;</li>
      <li><ks>COaP</ks>.</li>
    </ul>
    Afterwards, for every component will be discussed the best communication solution according to its task.
  </div>
</div>
<h4>Components overview</h4>
<div>
  <h3>WasteService </h3>
<div class="remark" id="problem_analysis_Waste_service">
  The WasteService(<b>WS</b>) is the core of the entire software system as it contains the business logic.
  The WasteService acts like a controller.
  The <kr>WS</kr> can be described as a <ks>service</ks>, managing various types of information coming from an external sensor (<ks>Sonar</ks>),
  receving messages (or commands from Service manager?) and controlling the transport trolley and the Led, it also sends information to the WasteServiceStatusGUI.
</div>
  <h3> Transport trolley </h3>
<div class="remark" id="problem_analysis_transport_trolley">
  <ks>Transport trolley</ks> must satisfy these requirements: <a href="#R1A">R1A</a>,  <a href="#R1B">R1B</a>, <a href="#R1C">R1C</a>, <a href="#R1D">R1D</a>, <a href="#R2A">R2A</a>.<br>
  At any time, the Service Manager can stop the tasks(??). Transport trolley aim leads to both active and passive behaviour. <br>
  As discussed in the requirements analysis, the <ks>transport trolley</ks> is represented as an actor. Since <ks>WS</ks> contains the business logic of the
  service, it must know the status of the <ks>transport trolley</ks>. At the same time, <ks>WS</ks> must be able to complete other tasks. For that reason,
  a non-blocking communication using <b>dispatches</b> is more situable. Alternatively, a <b>synchronous communication</b> would force the <ks>WS</ks> to wait
  the reply of the <ks>transport trolley</ks> after a command making the service less reactive.
  The <ks>transport trolley</ks> sends also a request to the <ks>WS</ks> to check if the TruckLoad is havier or not than the MAXCapacity and the <ks>WS</ks> reply.
  (An entity has to send information to WS to communicate that there is a new req, and also the type of waste and the weight? --> so WS ha to receive msg)
  (we have to return an Error to the wasteservice if a component of the truck is break? like a brocken led or wheel)
</div><br>
<table cellpadding="20%" style="border: 0px solid transparent;width:98%;" style="width:98%">
  <tr>
    <td style="border: 0px">
        <center><img src="images/Transport_trolley.png" alt="Transport_trolley" width="60%"><center>
    </td>
    <td style="border: 0px">
      <center><table cellpadding="5%">
        <tbody><tr>
            <th>Message</th>
            <th>Content</th>
            <th>Semantic</th>
        </tr>
        <tr>
            <td rowspan="3">??</td>
            <td>deposit_command</td>
            <td rowspan="3">dispatch</td>
        </tr>
        <tr>
            <td>loadaccept</td>
        </tr>
        <tr>
            <td>loadrejected</td>
        </tr>
        <tr>
            <td rowspan="3">??</td>
            <td>ok</td>
            <td rowspan="3">dispatch</td>
        </tr>
        <tr>
            <td>wait</td>
        </tr>
        <tr>
          <td>waste_action(type, kg)</td>
        </tr>
      </tr>
    </tbody></table></center>
  </td>
</tr>
</table>
<br>
<h3> Led </h3>
<div class="remark" id="Led">
The <ks>Led</ks> does not own or produce any valuable information by itself but it is a component controlled by the system.
The status of the <ks>led</ks> can be changed by the <ks>WS</ks> through three commands "<kr>turn_on</kr>" , "<kr>turn_off</kr>" and "<kr>blink</kr>". As a result of the command, the led replies
with its new state. 
This implies that the led can only be in three states, one is "on" which indicates that the <ks>transport trolley</ks> is stopped , the second one is "off" and indicates that the  <ks>transport trolley</ks> is at HOME, the last one is "blink" and indicates that the <ks>transport trolley</ks> is moving,
The interaction between the <ks>led</ks> and the <ks>WS</ks>  is more predisposed to a <b>synchronous semantics</b>.
( we have though about a Led Fail (it breaks), maybe a Fail led status?)
</div> <br>
<table cellpadding="20%" style="border: 0px solid transparent;width:98%;" style="width:98%">
  <tr>
    <td style="border: 0px">
        <center><img src="images/Led.png" alt="Led" width="60%"><center>
    </td>
    <td style="border: 0px">
      <center><table cellpadding="5%">
        <tbody><tr>
            <th>Message</th>
            <th>Content</th>
            <th>Semantic</th>
        </tr>
        <tr>
            <td rowspan="3">command</td>
            <td>turn_on</td>
            <td rowspan="3">request</td>
        </tr>
        <tr>
          <td>turn_blink</td>
        </tr>
        <tr>
            <td>turn_off</td>
        </tr>
        <tr>
            <td rowspan="3">rep_status</td>
            <td>on</td>
            <td rowspan="3">reply</td>
        </tr>
        <tr>
          <td>blinks</td>
        </tr>
        <tr>
            <td>off</td>
        </tr>
    </tbody></table></center>
  </td>
</tr>
</table>
<br>
<hr size="4" color="black">
<br>
<div class="remark">
  Requirements analysis shows that the <ks>Sonar</ks> is an autonomous active (??)
  component which emit information in a continuous way. For this reason, the sensors below don't need any replies during the interaction with the <ks>WS</ks>.
 <br>
  This behaviour leads to an asynchronous communication that can be developed through different forms:
  <ul>
    <li><b>Dispatches</b>: sent from sensor to the <ks>WS</ks>;</li>
    <li><b>Polling</b>: where the <ks>WS</ks> makes, at a regular interval of time, requests to the sensor;</li>
     <li><b>Events</b>: generated from the sensor and sent in broadcast through networks.</li>
  </ul>
 the Sonar isn't aware about the rest of the system(???)
  This leads to events being the best form of interaction between components and the <ks>WS</ks>.
</div>
<div id="problem_analysis_sonar">
  <h3> Sonar </h3>
  <div class="remark">
    The <ks>Sonar</ks> is used as an ‘alarm device’: when it measures a distance less that a prefixed value <ks>DLIMT</ks>, the transport trolley must be stopped. It will be resumed when Sonar detects again a distance higher than DLIMT.
    Il Sonar manda continuamente la misura al WS (??)
    <br>
  </div>
  <table cellpadding="20%" style="border: 0px solid transparent;width:98%;" style="width:98%">
    <tr>
      <td style="border: 0px">
          <center><img src="images/Sonar.png" alt="Sonar" width="60%"><center>
      </td>
      <td style="border: 0px">
        <center>
    <table cellpadding="5%">
        <tr>
          <th>Message</th>
          <th>Content</th>
          <th>Type</th>
        </tr>
        <tr>
          <td>event</td>
          <td>distance, timestamp</td>
          <td>event</td>
        </tr>
   </table>
 </center>
</td>
</tr>
</table>
</div>

<div id="problem_analysis_Service_Area">
  <h3> Service_Area ?? </h3>
  
<div id="problem_analysis_GUI_overview">
  <h4>GUI overview</h4>
  <div class="remark">
   To implement the GUI we will try to make it more easy and lighter, we'll probably use SpringBoot (and other tools), the service-manager interface should be clear and user-friendly.
  </div>
</div>
<div id="problem_analysis_waste_service_status_GUI">
  <h3>WasteServiceStatusGUI</h3>
  <div class="remark">
    The Service Manager's interface must be able to show these <a id="status">status</a>:
    <ul>
      <li> the current state of the <ks>trasport trolley</ks> and its position;</li>
      <li> the current weight of the material stored in the two containers (the plastic one and the glass one);</li>
      <li> the current state of the Led (on, blinks, off).</li>
    (1 dispatch or 3 ? )
    </ul>
  </div>
  <table cellpadding="20%" style="border: 0px solid transparent;width:98%;" style="width:98%">
    <tr>
      <td style="border: 0px">
        <center><img src="images/WasteServiceStatusGUI.png" alt="WasteServiceStatusGUI" width="65%"></center>
      </td>
      <td style="border: 0px">
        <center>
          <table cellpadding="5%">
            <tbody>
              <tr>
                <th>Message</th>
                <th>Content</th>
                <th>Type</th>
              </tr>


              <tr>
                <td>System Status</td>
                <td><a href="#status">check status</a></td>
                <td>dispatch</td>
              </tr>

            </tbody>
          </table>
        </center>
      </td>
    </tr>
  </table>
</div>

<div id="abstraction_gap">
  <h3>Abstraction gap</h3>
  <div class="remark">
    After the initial analysis it emerged that the main gap concerns the communication between the components of the system. 
    Another goal that we have set ourselves is to develop a code that was independent of the technologies used, so that it can also be reused in other distributed applications.
    The abstraction gap between system designer and the technologies is filled by programming languages like Kotlin, that gives us a solution to describe actors.
  </div>
</div>
<div id="system_weakness">
  <h4>System weaknesses</h4>
  <div class="remark">
    The system may soffer rarely these case studies:
    <ul>
      <li>Network problem: it could lead to a malfuction of the system;</li>
      <li>Comunication problem ?: latecy of response could lead to bad requests management;</li>
      <li>Some informations, such as the used capacity of the containers, are in the business logic. In case of system faults, these data can be lost.</li>
    </ul>
  </div>
</div>
<div id="logical_architecture">
  <h3>Logical Architecture</h3>
  From the previous considerations on the components of the system it is possible to define a first logical architecture: <br><br>
  <center><img src="images/LogicalArchitecture.png" alt="logical_architecture" width="40%"></center>

  <div class="remark">
    In order to make our waste software reusable and as much as possibile independent from the undelying communication protocols,
    the designer could make reference to proper design pattern such as <b>Adapter</b>, <b>Bridge</b> , <b>Facade</b> ,  <b>Singleton</b>, <b>Proxy</b> and <b>Decorator</b>. 
  </div>
  <div class="remark">
    User-Story:
  </div>
</div>

<h2>Test plans</h2>
<div id="test_plans">
  <div class="remark">
  </div>
</div>

<h2>Work Plan</h2>
<div id="work_plan">
  <div class="remark">
    
  </div>
</div>


<h2>Project</h2>

</div>

<h2>Testing</h2>


<h2>Deployment</h2>


<h2>Maintenance</h2>

<br/><br/>
</div>

<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
<li>By Bignami Filippo, Greco Davide</li>
<li>email: filippo.bignami@studio.unibo.it,  davide.greco4@studio.unibo.it</li>
<li>GitHub repository: https://github.com/GrikFreak/issTemaFinale22</li>
</div>
</body>
</html>
